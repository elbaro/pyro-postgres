<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>pyro-postgres Benchmark Results</title>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <style>
            body {
                font-family:
                    -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                    Oxygen, Ubuntu, sans-serif;
                margin: 0;
                padding: 20px;
                background-color: #f5f5f5;
            }
            .container {
                max-width: 1200px;
                margin: 0 auto;
                background-color: white;
                padding: 30px;
                border-radius: 10px;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }
            h1 {
                text-align: center;
                color: #333;
                margin-bottom: 10px;
            }
            h2 {
                color: #444;
                margin-top: 40px;
                border-bottom: 2px solid #eee;
                padding-bottom: 10px;
            }
            .subtitle {
                text-align: center;
                color: #666;
                margin-bottom: 30px;
            }
            .chart-container {
                position: relative;
                height: 400px;
                margin-bottom: 40px;
            }
            table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
                margin-bottom: 40px;
            }
            th,
            td {
                padding: 12px;
                text-align: right;
                border-bottom: 1px solid #ddd;
            }
            th {
                background-color: #f8f9fa;
                font-weight: 600;
            }
            th:first-child,
            td:first-child {
                text-align: left;
            }
            tr:hover {
                background-color: #f5f5f5;
            }
            .best {
                background-color: #e8f5e9;
            }
            .legend {
                text-align: center;
                margin-top: 20px;
                color: #666;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>pyro-postgres Benchmark Results</h1>
            <p class="subtitle">
                Best execution time per library (lower is better) - Using best
                variant (normal/executemany/batch/pipeline)
            </p>

            <h2>Sync Benchmarks</h2>
            <div class="chart-container">
                <canvas id="syncChart"></canvas>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Benchmark</th>
                        <th>pyro (µs)</th>
                        <th>psycopg (µs)</th>
                        <th>Speedup</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SELECT_1</td>
                        <td class="best">39.22</td>
                        <td class="">103.92</td>
                        <td>2.65x</td>
                    </tr>
                    <tr>
                        <td>SELECT_10</td>
                        <td class="best">46.46</td>
                        <td class="">113.17</td>
                        <td>2.44x</td>
                    </tr>
                    <tr>
                        <td>SELECT_100</td>
                        <td class="best">112.13</td>
                        <td class="">177.76</td>
                        <td>1.59x</td>
                    </tr>
                    <tr>
                        <td>SELECT_1000</td>
                        <td class="best">569.89</td>
                        <td class="">810.31</td>
                        <td>1.42x</td>
                    </tr>
                    <tr>
                        <td>INSERT</td>
                        <td class="best">6.42</td>
                        <td class="">19.52</td>
                        <td>3.04x</td>
                    </tr>
                </tbody>
            </table>

            <h2>Async Benchmarks</h2>
            <div class="chart-container">
                <canvas id="asyncChart"></canvas>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Benchmark</th>
                        <th>pyro (µs)</th>
                        <th>psycopg (µs)</th>
                        <th>asyncpg (µs)</th>
                        <th>Speedup (vs psycopg)</th>
                        <th>Speedup (vs asyncpg)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>SELECT_1</td>
                        <td class="best">128.65</td>
                        <td class="">150.92</td>
                        <td class="">146.21</td>
                        <td>1.17x</td>
                        <td>1.14x</td>
                    </tr>
                    <tr>
                        <td>SELECT_10</td>
                        <td class="best">145.96</td>
                        <td class="">164.96</td>
                        <td class="">153.40</td>
                        <td>1.13x</td>
                        <td>1.05x</td>
                    </tr>
                    <tr>
                        <td>SELECT_100</td>
                        <td class="">244.57</td>
                        <td class="">273.96</td>
                        <td class="best">227.53</td>
                        <td>1.12x</td>
                        <td>0.93x</td>
                    </tr>
                    <tr>
                        <td>SELECT_1000</td>
                        <td class="">1041.08</td>
                        <td class="">965.05</td>
                        <td class="best">730.82</td>
                        <td>0.93x</td>
                        <td>0.70x</td>
                    </tr>
                    <tr>
                        <td>INSERT</td>
                        <td class="best">6.74</td>
                        <td class="">98.16</td>
                        <td class="">7.18</td>
                        <td>14.56x</td>
                        <td>1.07x</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <script>
            function initCharts() {
                // Sync Chart
                const syncCtx = document
                    .getElementById("syncChart")
                    .getContext("2d");
                new Chart(syncCtx, {
                type: "bar",
                data: {
                    labels: [
                        "SELECT_1",
                        "SELECT_10",
                        "SELECT_100",
                        "SELECT_1000",
                        "INSERT",
                    ],
                    datasets: [
                        {
                            label: "pyro (sync)",
                            data: [39.22, 46.46, 112.13, 569.89, 6.42],
                            backgroundColor: "rgba(76, 175, 80, 0.8)",
                            borderColor: "rgba(76, 175, 80, 1)",
                            borderWidth: 1,
                        },
                        {
                            label: "psycopg (sync)",
                            data: [103.92, 113.17, 177.76, 810.31, 19.52],
                            backgroundColor: "rgba(33, 150, 243, 0.8)",
                            borderColor: "rgba(33, 150, 243, 1)",
                            borderWidth: 1,
                        },
                    ],
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: "Sync Execution Time",
                            font: { size: 16 },
                        },
                        legend: {
                            position: "top",
                        },
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: "Time (µs)",
                            },
                            ticks: {
                                callback: function (value) {
                                    return value.toLocaleString() + " µs";
                                },
                            },
                        },
                        x: {
                            title: {
                                display: true,
                                text: "",
                            },
                        },
                    },
                },
            });

            // Async Chart
            const asyncCtx = document
                .getElementById("asyncChart")
                .getContext("2d");
            new Chart(asyncCtx, {
                type: "bar",
                data: {
                    labels: [
                        "SELECT_1",
                        "SELECT_10",
                        "SELECT_100",
                        "SELECT_1000",
                        "INSERT",
                    ],
                    datasets: [
                        {
                            label: "pyro (async)",
                            data: [128.65, 145.96, 244.57, 1041.08, 6.74],
                            backgroundColor: "rgba(76, 175, 80, 0.8)",
                            borderColor: "rgba(76, 175, 80, 1)",
                            borderWidth: 1,
                        },
                        {
                            label: "psycopg (async)",
                            data: [150.92, 164.96, 273.96, 965.05, 98.16],
                            backgroundColor: "rgba(33, 150, 243, 0.8)",
                            borderColor: "rgba(33, 150, 243, 1)",
                            borderWidth: 1,
                        },
                        {
                            label: "asyncpg",
                            data: [146.21, 153.4, 227.53, 730.82, 7.18],
                            backgroundColor: "rgba(255, 152, 0, 0.8)",
                            borderColor: "rgba(255, 152, 0, 1)",
                            borderWidth: 1,
                        },
                    ],
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: "Async Execution Time",
                            font: { size: 16 },
                        },
                        legend: {
                            position: "top",
                        },
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: "Time (µs)",
                            },
                            ticks: {
                                callback: function (value) {
                                    return value.toLocaleString() + " µs";
                                },
                            },
                        },
                        x: {
                            title: {
                                display: true,
                                text: "",
                            },
                        },
                    },
                },
            });
            }

            // Wait for Chart.js to load (handles htmlpreview.github.io timing issues)
            if (typeof Chart !== 'undefined') {
                initCharts();
            } else {
                window.addEventListener('load', initCharts);
            }
        </script>
    </body>
</html>
